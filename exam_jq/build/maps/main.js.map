{"version":3,"names":[],"mappings":"","sources":["main.js"],"sourcesContent":["//Класс слайдера\r\nfunction Slider(element, frame) {\r\n\tthis.frame = frame;\r\n\tthis.imgs = element.querySelectorAll('.slider__scr');\r\n\t\r\n\tthis.set(this.frame, 'block');\r\n};\t\r\n\r\nSlider.prototype.set = function(frame, value) { // установка нужного фона слайдеру\r\n\tthis.imgs[frame].style.display = value;\r\n};\r\n\r\nSlider.prototype.left = function() { // крутим на один кадр влево\r\n\tthis.set(this.frame, 'none');\r\n\tthis.frame--;\r\n\tif(this.frame < 0) this.frame = this.imgs.length-1;\r\n\tthis.set(this.frame, 'block');\r\n};\r\n\r\nSlider.prototype.right = function() { // крутим на один кадр вправо\r\n\tthis.set(this.frame, 'none');\r\n\tthis.frame++;\r\n\tif(this.frame === this.imgs.length) this.frame = 0;\r\n\tthis.set(this.frame, 'block');\r\n};\r\n//Класс слайдера\r\n\r\n\r\n(function ($) {\r\n\t'use strict';\r\n\t\r\n\t$(function () {\r\n\r\n\t\t$('.grid').masonry({\r\n\t\t\titemSelector: '.grid__item', \r\n\t\t\tcolumnWidth: '.grid__sizer',\r\n//\t\t\tpercentPosition: true,\r\n\t\t\tgutter: 1\r\n\t\t});\r\n\t\t\r\n\t\tvar sliders = document.querySelectorAll('.slider');\r\n\t\twindow.mySliders = [];\r\n\t\tfor (var sl = 0; sl < sliders.length; sl++) {\r\n\t\t\twindow.mySliders.push(new Slider(sliders[sl], sl));\t\r\n\t\t}\r\n\t\t\r\n\t\tvar isPicturesReceived = false;\r\n\t\t\r\n\t\tfunction getPictures (request) {\r\n\t\t\tvar q = request ? '&q='+encodeURIComponent(request) : '';\r\n\t\t\t$.ajax({\r\n\r\n\t\t\t\turl: \"https://pixabay.com/api/?key=2654122-2e7cfe65e4216a71a55f9c97a&image_type=photo\"+q+\"&callback=?\",\r\n\t\t\t\tdataType: \"jsonp\",\r\n\t\t\t\tsuccess: function (data) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (data) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < 7; i++) {\r\n\t\t\t\t\t\t\tvar $img = $('.grid__item--'+(i+1)+' .grid__item-img');\r\n\t\t\t\t\t\t\tif (data.hits[i]) {\r\n\t\t\t\t\t\t\t\t$img[0].src = data.hits[i].webformatURL;\r\n\t\t\t\t\t\t\t\t$img.parent().find('.grid__caption').html(data.hits[i].tags);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t$img[0].src = '';\r\n\t\t\t\t\t\t\t\t$img.parent().find('.grid__caption').html('Empty');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// Масштабировать картинку плагином\r\n\t\t\t\t\t\tvar $gridItem = $('.grid__item');\r\n\t\t\t\t\t\tvar $gridItemImg = $gridItem.find('.grid__item-img');\r\n\t\t\t\t\t\tif ($gridItem.imagefill) {\r\n\t\t\t\t\t\t\t$gridItem.imagefill();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// Если плагин не доступен (ie8), то заполнить по ширине\r\n\t\t\t\t\t\t\t$gridItemImg.css({\"width\": \"100%\", \"position\": \"relative\"});\r\n\r\n\t\t\t\t\t\t\tfor (var i = 0; i < $gridItem.length; i++) {\r\n\t\t\t\t\t\t\t\t// Если контейнер не заполнен, то заполнить по высоте\r\n\t\t\t\t\t\t\t\tif ($gridItem[i].offsetHeight > $gridItemImg[i].offsetHeight) {\r\n\t\t\t\t\t\t\t\t\t$($gridItemImg[i])\r\n\t\t\t\t\t\t\t\t\t\t.css({\"height\": \"100%\", \"width\": \"\", \"position\": \"relative\"});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tisPicturesReceived = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t}\r\n\r\n\t\t// Сервис работает ненадежно\r\n\t\t// Повторяем попытку загрузить пока не загрузится\r\n\t\t// Проблемы загрузки можно увидеть в консоли\r\n\t\tfunction refreshGrid(request) {\r\n\t\t\t\r\n\t\t\tgetPictures(request);\r\n\t\t\t\r\n\t\t\tif (!isPicturesReceived) {\r\n\t\t\t\t\r\n\t\t\t\tvar tryInterval = setInterval( \r\n\t\t\t\t\tfunction () {\r\n\t\t\t\t\t\tif (isPicturesReceived) {\r\n\t\t\t\t\t\t\tclearInterval(tryInterval);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tgetPictures(request);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, 2000);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\trefreshGrid();\r\n\t\t\r\n\t\t$('.request-area .round-button').on('click', function (e) {\r\n\t\t\tvar r = $('.request-area input').val();\r\n\t\t\trefreshGrid(r);\r\n//\t\t\te.stopImmediatePropagation();\r\n//\t\t\te.preventDefault();\r\n\t\t});\r\n\t\t\r\n\t});\r\n\t\r\n})(jQuery);"],"file":"main.js","sourceRoot":"/source/"}